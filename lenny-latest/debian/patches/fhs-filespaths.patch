Description: Prepare the sources to better respect FHS
 This patch was historically very long but most parts have
 been integrated upstream.
 .
 The last remaining bit is the location of "private files
 We historically have them in /var/lib/samba while upstream
 has them in /etc/samba
 .
 We need to provide a migraiton path and go back to the "normal"
 file layout
Author: Eloy A. Paris <peloy@debian.org>
Bug-Debian: http://bugs.debian.org/49011
Forwarded: not-needed


Index: experimental/source3/passdb/pdb_tdb.c
===================================================================
--- experimental.orig/source3/passdb/pdb_tdb.c
+++ experimental/source3/passdb/pdb_tdb.c
@@ -1255,7 +1255,7 @@
 	/* save the path for later */
 
 	if (!location) {
-		if (asprintf(&tdbfile, "%s/%s", lp_private_dir(),
+		if (asprintf(&tdbfile, "%s/%s", get_dyn_STATEDIR(),
 			     PASSDB_FILE_NAME) < 0) {
 			return NT_STATUS_NO_MEMORY;
 		}
Index: experimental/source3/passdb/secrets.c
===================================================================
--- experimental.orig/source3/passdb/secrets.c
+++ experimental/source3/passdb/secrets.c
@@ -61,7 +61,7 @@
 		return True;
 
 	fname = talloc_asprintf(talloc_tos(), "%s/secrets.tdb",
-				lp_private_dir());
+				get_dyn_STATEDIR());
 	if (fname == NULL) {
 		return false;
 	}
