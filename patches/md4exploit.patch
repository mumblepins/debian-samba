diff -uNr samba-2.2.3a.orig/source/libsmb/smbencrypt.c samba-2.2.3a/source/libsmb/smbencrypt.c
--- samba-2.2.3a.orig/source/libsmb/smbencrypt.c	2002-02-02 18:46:44.000000000 -0600
+++ samba-2.2.3a/source/libsmb/smbencrypt.c	2002-11-04 19:26:06.000000000 -0600
@@ -63,7 +63,7 @@
 	if(len > 128)
 		len = 128;
 	/* Password must be converted to NT unicode - null terminated. */
-	dos_struni2((char *)wpwd, (const char *)passwd, 256);
+	dos_struni2((char *)wpwd, (const char *)passwd, 128);
 	/* Calculate length in bytes */
 	len = strlen_w((const smb_ucs2_t *)wpwd) * sizeof(int16);
 
